stages:
  - deploy

deploy:
  stage: deploy
  script:
    - echo "Adding safe directory..."
    - git config --global --add safe.directory C:/Projects/FelArgailo
    - echo "Pulling latest code..."
    - cd C:/Projects/FelArgailo
    - git pull https://github.com/Selengiks/FelArgailo HEAD
    - docker compose stop FelArgailo
    - docker compose rm -f FelArgailo
    - docker compose build --no-cache
    - docker image prune -f
    - docker buildx prune -f
    - docker compose up -d FelArgailo

  only:
    - master
